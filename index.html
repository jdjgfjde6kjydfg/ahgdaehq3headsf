<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mini Clash Royale Advanced</title>
  <style>
    body { margin: 0; background: #1e272e; overflow: hidden; }
    canvas { background: #2f3640; display: block; margin: 0 auto; }
    #ui {
      position: absolute;
      bottom: 0; left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      padding: 10px;
    }
    .card {
      width: 80px; height: 100px;
      background: #333; color: white;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      font-family: Arial, sans-serif;
      border: 2px solid white;
      border-radius: 10px;
      cursor: grab;
      user-select: none;
    }
    .icon {
      width: 60px; height: 60px;
      border-radius: 50%;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
<canvas id="game" width="500" height="700"></canvas>
<div id="ui"></div>

<script>
// Setup
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const ui = document.getElementById("ui");

let units = [];
let projectiles = [];
let elixir = 5;
let gameOver = false;

// Towers
class Tower {
  constructor(x, y, hp, side, isKing=false) {
    this.x = x; this.y = y;
    this.hp = hp; this.side = side;
    this.isKing = isKing;
    this.range = isKing ? 150 : 120;
    this.dmg = isKing ? 0.25 : 0.15;
    this.cooldown = 0;
  }
  draw() {
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.fillStyle = this.side==="blue" ? "#2980b9" : "#c0392b";
    ctx.fillRect(-20,-20,40,40);
    if (this.isKing) {
      ctx.fillStyle="gold"; ctx.fillRect(-10,-30,20,10);
    }
    ctx.restore();

    // HP bar
    ctx.fillStyle="red";
    ctx.fillRect(this.x-20,this.y-30,40,5);
    ctx.fillStyle="lime";
    ctx.fillRect(this.x-20,this.y-30,40*(this.hp/300),5);
  }
  update() {
    if (this.hp<=0) return;
    this.cooldown--;
    if (this.cooldown<=0) {
      // find nearest enemy unit
      let target = units.find(u =>
        u.side!==this.side &&
        Math.hypot(u.x-this.x,u.y-this.y)<this.range
      );
      if (target) {
        projectiles.push(new Projectile(this.x,this.y,target,this.dmg,this.side));
        this.coo
